#!groovy

pipeline {
    agent any

    stages {
		stage('Build') {
			steps {
				echo "=== build ==="
				sh """
				sudo docker build -t paint -f ./ci/docker/paint.dockerfile .
				"""
			}
		}

        stage('ansible playbook'){
			steps{
			 	script{
				    //ansiblePlaybook become: false, installation: 'ansible', inventory: './ci/hosts', playbook: './ci/ansible.yaml'
					sh """
					ansible-playbook /ci/ansible.yml -i /ci/hosts.ini --user=serezhka \
                              --extra-vars "ansible_sudo_pass=ugatu"
					"""
				}
			}
		}
	}
}